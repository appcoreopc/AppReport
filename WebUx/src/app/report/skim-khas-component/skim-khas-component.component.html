 

<div class="container">

 

	<p-dialog id="formAction" header="{{formTitle}}" [(visible)]="display" modal='true'>



		<p-tabView [activeIndex]="tabIndex" >

			<p-tabPanel header="Basic Entry" (click)="changeTab(0)">

				<form [formGroup]='dataForm'>

					<div style="width:1000px;padding:0px">

						<div class="panel panel-info">
							<div class="panel-body" style="padding:5px; padding-left:30px">


								<div class="form-group row">
									<div class="cell c1">
										<label for="refNo">Reference No :</label>
									</div>
									<div class="cell c2">
										<input id="refNo" type="text" class="form-control text-control" formControlName="refNo" />
									</div>
									<div class="cell c3">
									</div>
									<div class="cell c4">
										<label for="letterDate">Date of Letter :</label>
									</div>
									<div class="cell c5">
										<p-calendar dateFormat="dd/mm/yy" formControlName="letterDate" [showIcon]="true" [monthNavigator]="true"></p-calendar>
										<div *ngIf="formErrors.letterDate" class="alert alert-danger">
											{{ formErrors.letterDate }}
										</div>
									</div>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="rptDate">Report Month/Year :</label>
									</div>
									<div class="cell c2">
										<p-calendar dateFormat="M yy" formControlName="rptDate" showIcon="true"></p-calendar>

										<div *ngIf="formErrors.rptDate" class="alert alert-danger">
											{{ formErrors.rptDate }}
										</div>
									</div>
									<div class="cell c3">
									</div>
									<div class="cell c4">
									</div>
									<div class="cell c5">
									</div>
								</div>



								<div class="form-group row" style="padding-top:20px">
									<b>Recipient</b>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="LRcptDept">Department :</label>
									</div>
									<div class="cell c2345">
										<input id="LRcptDept" type="text" class="form-control text-control" formControlName="lrcptDept" />
									</div>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="LRcptBr">Branch :</label>
									</div>
									<div class="cell c2345">
										<input id="LRcptBr" type="text" class="form-control text-control" formControlName="lrcptBr" />
									</div>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="LRcptAdd1">Address :</label>
									</div>
									<div class="cell c2345">
										<input id="LRcptAdd1" type="text" class="form-control text-control" formControlName="lrcptAdd1" />
									</div>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="LRcptAdd2"></label>
									</div>
									<div class="cell c2345">
										<input id="LRcptAdd2" type="text" class="form-control text-control" formControlName="lrcptAdd2" />
									</div>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="LRcptAdd3"></label>
									</div>
									<div class="cell c2345">
										<input id="LRcptAdd3" type="text" class="form-control text-control" formControlName="lrcptAdd3" />
									</div>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="LRcptAdd4"></label>
									</div>
									<div class="cell c2345">
										<input id="LRcptAdd4" type="text" class="form-control text-control" formControlName="lrcptAdd4" />
									</div>
								</div>


								<div class="form-group row" style="padding-top:20px">
									<b>Signed By</b>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="signedByEmpId">Employee :</label>
									</div>
									<div class="cell c2345">
										<select class="form-control" formControlName="signedByEmpId" style="width:300px" (change)="onEmpChange($event.target.value)">
											<option *ngFor="let obj of empRows" [value]="obj.empId">{{obj.empName}}</option>
										</select>
									</div>
								</div>
								<div class="form-group row">
									<div class="cell c1">
										<label for="SignedByName">Name :</label>
									</div>
									<div class="cell c2345">
										<input id="SignedByName" type="text" class="form-control text-control" formControlName="signedByName" />
									</div>
								</div>


								<div class="form-group row">
									<div class="cell c1">
										<label for="icno">IC
											<Noscript></Noscript> :</label>
									</div>
									<div class="cell c2345">
										<input id="icno" type="text" class="form-control text-control" formControlName="signedByIdno" />
									</div>
								</div>

								<div class="form-group row">
									<div class="cell c1">
										<label for="SignedByPos">Position :</label>
									</div>
									<div class="cell c2345">
										<input id="SignedByPos" type="text" class="form-control text-control" formControlName="signedByPos" />
									</div>
								</div>
							</div>



						</div>

						<div class="form-group row">
							<div class="cell c1">
							</div>
							<div class="cell c2">
							</div>
							<div class="cell c3">
							</div>
							<div class="cell c4">
							</div>
							<div class="cell c5">

								<p-button icon="fa fa-fw fa-save" label="Save" [disabled]="!dataForm.valid" (click)="save()"></p-button>
							</div>
						</div>

						<p>Form value: {{ dataForm.value | json }}</p>

					</div>


				</form>

			</p-tabPanel>

			<p-tabPanel header="Detail Entry" [(disabled)]="enabledDetailEntry" (click)="changeTab(0)">


				<p-button icon="fa fa-fw fa-save" label="Add new entry" (click)="showEntryForm()">
				</p-button>

				<p-table #dtEntry (onRowExpand)="onRowExpanded($event)" [columns]="dataEntryColumns" [value]="data.rptSkMimp" selectionMode="single"
				 [paginator]="true" [rows]="10" dataKey="txnId">

					<ng-template pTemplate="header" let-dataEntryColumns>
						<tr>
							<th style="width: 2.25em"></th>
							<th *ngFor="let col of dataEntryColumns">
								{{col.header}}
							</th>
						</tr>
					</ng-template>

					<ng-template pTemplate="body" let-rowData let-columns="columns" let-expanded="expanded" columns="columns">
						<tr [pSelectableRow]="rowData">
							<td>
								<div [pRowToggler]="rowData">
									<i [ngClass]="expanded ? 'fa fa-fw fa-chevron-circle-down' : 'fa fa-fw fa-chevron-circle-right'"></i>
								</div>
							</td>

							<td *ngFor="let col of columns">
								{{rowData[col.field]}}
							</td>
						</tr>

					</ng-template>


					<ng-template pTemplate="rowexpansion" let-rowData let-columns="columns">

						<tr>

							<form [formGroup]='expandEditForm'>

								<td [attr.colspan]="columns.length + 1">

									<div style="width:1000px;padding:0px">
										<div class="panel panel-info">
											<div class="panel-body" style="padding:5px; padding-left:30px">

												<!--<div class="form-group row">
													<div class="cell c1">
														<label for="tarikh">Tarikh</label>
													</div>
													<div class="cell c2345">
															<p-calendar dateFormat="dd/mm/yy" formControlName="fImpDate" [showIcon]="true" [monthNavigator]="true"></p-calendar>
													</div>

												</div>
												<div class="form-group row">
													<div class="cell c1">
														<label for="nobarang">No Barang</label>
													</div>
													<div class="cell c2345">
														<input id="nobarang" formControlName="fCustomNo" type="text" class="form-control text-control" />
													</div>
												</div>

												<div class="form-group row">
													<div class="cell c1">
														<label for="kuantitiImport">Kuantiti Import</label>
													</div>
													<div class="cell c2345">
														<input id="kuantitiImport" formControlName="fImpWgt" type="number" class="form-control text-control" />
													</div>
												</div>

												<div class="form-group row">
													<div class="cell c1">
														<label for="nilaiImport">Nilai Import</label>
													</div>
													<div class="cell c2345">
														<input id="nilaiImport" formControlName="fImpCost" type="number" class="form-control text-control" />
													</div>
												</div>-->

												<div class="form-group row">
													<div class="cell c1">
														<label for="catatan">Catatan</label>
													</div>
													<div class="cell c2345">
														<input id="catatan" type="text" formControlName="note" class="form-control text-control" />
													</div>
												</div>

												<div class="form-group row">
													<div class="cell c1">
														<label for="catatan"></label>
													</div>
													<div class="cell c2345">

														<p-button icon="fa fa-fw fa-plus" label="Save" (click)="onGridRowSave(rowData, dtEntry)"></p-button>
														<p-button icon="fa fa-fw fa-plus" label="Cancel" (click)="onGridRowCancel(rowData, dtEntry)"></p-button>

													</div>
												</div>
											</div>
										</div>
									</div>



								</td>

							</form>

						</tr>

					</ng-template>

				</p-table>

				<div>

					<div>

						<p>Form value: {{ dataForm.value | json }}</p>
					</div>

				</div>

				<div class="container">

					<p-button icon="fa fa-fw fa-plus" label="Save Skim Khas" (click)="save()"></p-button>
				</div>


			</p-tabPanel>



		</p-tabView>

	</p-dialog>

</div>


<div class="container">

	<p-button (onClick)="addForm()" icon="fa fa-fw fa-plus" label="Add"></p-button>

	<p-button (onClick)="editForm()" icon="fa fa-fw fa-edit" label="Edit"></p-button>

	<p-button (onClick)="printReport()" icon="fa fa-fw fa-print" label="Print"></p-button>
 
</div>



<div style="clear:both; height:10px"></div>


<div class="container">
 
 
   <p-table [columns]="mainColumns" [value]="rows" selectionMode="single" [paginator]="true" [rows]="10" (onRowSelect)="onRowSelect($event)">
  
	<ng-template pTemplate="header" let-dataEntryColumns>
			<tr [pSelectableRow]="rowData">
				<th>Report Id</th>
				<th>Report Month/Year</th>
				<th>Reference No</th>
				<th>Nilai Barang Diimport (RM)</th>
				<th>Amount GST Digantung (RM)</th>
			</tr>
		</ng-template>
		
  <ng-template pTemplate="body" let-rowData let-columns="columns" let-expanded="expanded" columns="columns">
		 <tr [pSelectableRow]="rowData">
            <td>{{rowData.rptId}}</td>
            <td>{{rowData.rptDate | date: 'MMM / yyyy'}}</td> 
            <td>{{rowData.refNo}}</td> 
            <td>{{rowData.fImpCost | number:'1.2-2'}}</td>
            <td>{{rowData.fGstcost | number:'1.2-2'}}</td>
        </tr>
    </ng-template> 
</p-table>

</div>

<p-dialog id="formAction" header="{{formTitle}}" [(visible)]="displayDataEntry" modal='true'>

	<form [formGroup]='entryDetailForm'>

		<div style="width:1000px;padding:0px">
			<div class="panel panel-info">
				<div class="panel-body" style="padding:5px; padding-left:30px">

					<div class="form-group row">
						<div class="cell c1">
							<label for="tarikh">Tarikh</label>
						</div>
						<div class="cell c2345">
							<p-calendar dateFormat="dd/mm/yy" formControlName="fImpDate" [showIcon]="true" [monthNavigator]="true"></p-calendar>
						</div>

						<div *ngIf="detailFormError.fImpDate" class="alert alert-danger">
							{{ detailFormError.fImpDate }}
						</div>

					</div>
					<div class="form-group row">
						<div class="cell c1">
							<label for="nobarang">No Barang</label>
						</div>
						<div class="cell c2345">
							<input id="nobarang" type="text" formControlName="fCustomNo" class="form-control text-control" />
						</div>
					</div>

					<div class="form-group row">
						<div class="cell c1">
							<label for="kuantitiImport">Kuantiti Import</label>
						</div>
						<div class="cell c2345">
							<input id="kuantitiImport" type="number" formControlName="fImpWgt" class="form-control text-control" />
						</div>

						<div *ngIf="detailFormError.fImpWgt" class="alert alert-danger">
							{{ detailFormError.fImpWgt }}
						</div>
					</div>

					<div class="form-group row">
						<div class="cell c1">
							<label for="nilaiImport">Nilai Import</label>
						</div>
						<div class="cell c2345">
							<input id="nilaiImport" type="number" formControlName="fImpCost" class="form-control text-control" />
						</div>
					</div>

					<div class="form-group row">
						<div class="cell c1">
							<label for="gstImport">GST </label>
						</div>
						<div class="cell c2345">
							<input id="gstImport" type="number" formControlName="fGstcost" class="form-control text-control" />
						</div>
					</div>

					<div class="form-group row">
						<div class="cell c1">
							<label for="catatan">Catatan</label>
						</div>
						<div class="cell c2345">
							<input id="catatan" type="text" formControlName="note" class="form-control text-control" />
						</div>

						<div *ngIf="detailFormError.note" class="alert alert-danger">
							{{ detailFormError.note }}
						</div>
					</div>

					<div class="form-group row">
						<div class="cell c1">
						</div>
						<div class="cell c2345">
							<p-button icon="fa fa-fw fa-save" label="Create Entry" [disabled]="!entryDetailForm.valid" (click)="createEntry()">
							</p-button>
						</div>
					</div>

					<div>
						<p>Form value: {{ entryDetailForm.value | json }}</p>
					</div>

				</div>
			</div>
		</div>
	</form>
 
</p-dialog>

<p-dialog id="formPrintReport" header="Print SKIM Khas" [(visible)]="displayPrintReport" modal='true'> 
	 
	<a target="_self" class="btn btn-success" role="button" href="http://localhost:5050/rptsk/DownloadLetter/{{data.rptId}}">SKIM Khas Letter</a>
	&nbsp;
	<a target="_self" class="btn btn-primary" role="button"  href="http://localhost:5050/rptsk/DownloadReport/{{data.rptId}}">SKIM Khas Report</a>
</p-dialog>